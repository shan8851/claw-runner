#!/usr/bin/env bash
set -euo pipefail

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"

if [ ! -d "$DIR/.venv" ]; then
  python3 -m venv "$DIR/.venv"
  "$DIR/.venv/bin/pip" install -r "$DIR/requirements.txt"
fi

# Run the script by file path so it works even when the working directory is not the repo root (e.g. systemd).
exec "$DIR/.venv/bin/python" "$DIR/claw_runner/runner.py"
