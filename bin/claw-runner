#!/usr/bin/env bash
set -euo pipefail

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"

if [ ! -d "$DIR/.venv" ]; then
  python3 -m venv "$DIR/.venv"
  "$DIR/.venv/bin/pip" install -r "$DIR/requirements.txt"
fi

# Ensure the repo root is on PYTHONPATH so `python -m claw_runner.runner` works under systemd.
export PYTHONPATH="$DIR"
exec "$DIR/.venv/bin/python" -m claw_runner.runner
